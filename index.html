<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Crypto scanour Wealth Tracker</title>

<style>
  body {
    background: #000;
    color: white;
    font-family: Arial, sans-serif;
    padding: 18px;
    max-width: 600px;
    margin: auto;
  }

  input {
    width: 100%;
    padding: 14px;
    border-radius: 10px;
    border: none;
    margin-top: 10px;
    background: #111;
    color: white;
    font-size: 16px;
  }

  button {
    width: 100%;
    padding: 14px;
    margin-top: 14px;
    background: #0aff9d;
    border: none;
    border-radius: 10px;
    font-size: 17px;
    font-weight: bold;
    cursor: pointer;
    color: #000;
    transition: 0.2s;
  }

  button:hover {
    opacity: 0.85;
  }

  /* Loader animasi */
  #loader {
    display: none;
    margin-top: 20px;
    text-align: center;
  }

  .spinner {
    border: 4px solid #333;
    border-top: 4px solid #0aff9d;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    margin: auto;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    100% { transform: rotate(360deg); }
  }

  /* Token Card */
  .token-box {
    display: flex;
    background: #111;
    padding: 12px;
    margin-bottom: 12px;
    border-radius: 12px;
    align-items: center;
    gap: 14px;
    border: 1px solid #222;
  }

  .token-box img {
    width: 28px;
    height: 28px;
    border-radius: 50%;
  }

  /* ========================== */
  /* FIX LOGO BNB MEMBESAR     */
  /* ========================== */
  .chain-logo {
    width: 120px;     /* batas ukuran maksimum */
    height: auto;
    display: block;
    margin: 10px auto;
    max-width: 100%;
  }

  /* Universal protection (semua img tidak akan membesar) */
  img {
    max-width: 100%;
    height: auto;
  }

  @media (max-width: 480px) {
    .token-box {
      padding: 10px;
      gap: 10px;
    }
    .token-name { font-size: 16px; }
  }
</style>

</head>
<body>

<h2>Crypto Wealth Scanner </h2>

<input id="wallet" placeholder="Enter Your Wallet (0x...)" />

<button onclick="cekWallet()">Start Scanning</button>

<div id="loader">
  <div class="spinner"></div>
  <div style="margin-top:8px;color:#0aff9d;">Loading data...</div>
</div>

<div id="result"></div>

<script>
const API_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJub25jZSI6IjA2OTE5MmFmLTAxNzctNDBkYi04NjQwLTYzN2I0ZjJmNmNlMSIsIm9yZ0lkIjoiNDgzNjY0IiwidXNlcklkIjoiNDk3NjAzIiwidHlwZUlkIjoiYzU3ZjA0YTktNDM4Ni00MDQ5LWFhMGUtOWVmNTBmMmJlNWExIiwidHlwZSI6IlBST0pFQ1QiLCJpYXQiOjE3NjQzNzAyMzMsImV4cCI6NDkyMDEzMDIzM30.0kda5g8LQ3pI9SHBOaRK8dWkJSsELOWwQlojPEJDP_o";

const CHAINS = {
  "eth": "Ethereum",
  "bsc": "BNB Chain",
  "polygon": "Polygon",
  "arbitrum": "Arbitrum",
  "avalanche": "Avalanche",
  "optimism": "Optimism"
};

function shortAddr(addr) {
  return addr.slice(0, 6) + "..." + addr.slice(-4);
}

async function cekWallet() {
  const wallet = document.getElementById("wallet").value.trim();
  const loader = document.getElementById("loader");
  const result = document.getElementById("result");

  result.innerHTML = "";

  if (!wallet) {
    result.innerHTML = "Masukkan alamat wallet!";
    return;
  }

  loader.style.display = "block";

  let totalUSD = 0;
  let perChain = {};

  for (const chain in CHAINS) {
    try {
      const res = await fetch(
        `https://deep-index.moralis.io/api/v2.2/wallets/${wallet}/tokens?chain=${chain}`,
        { headers: { "X-API-Key": API_KEY } }
      );

      const data = await res.json();
      if (!data || !data.result) continue;

      let tokens = [];

      data.result.forEach(t => {
        if (!t.usd_price || t.usd_price === 0) return;
        if (t.possible_spam === true) return;

        const amount = t.balance / (10 ** t.decimals);
        const usdValue = amount * t.usd_price;

        if (usdValue < 0.1) return;

        totalUSD += usdValue;

        tokens.push({
          symbol: t.symbol,
          amount: amount,
          usd: usdValue,
          logo: t.logo || t.thumbnail || "https://via.placeholder.com/32",
          contract: t.token_address
        });
      });

      tokens.sort((a, b) => b.usd - a.usd);

      perChain[chain] = tokens;

    } catch (err) {
      console.error("Chain error:", chain, err);
    }
  }

  loader.style.display = "none";

  result.innerHTML = `<h2>Value: $${totalUSD.toFixed(2)}</h2>`;

  for (const chain in perChain) {
    const tokens = perChain[chain];
    if (!tokens || tokens.length === 0) continue;

    result.innerHTML += `<h3>${CHAINS[chain]}</h3>`;

    tokens.forEach(t => {
      result.innerHTML += `
        <div class="token-box">
          <img src="${t.logo}">
          <div style="flex:1;">
            <div class="token-name" style="font-size:18px;font-weight:bold;">${t.symbol}</div>
            <div style="font-size:14px;color:#ccc;">
              ${t.amount.toFixed(4)} â€” $${t.usd.toFixed(2)}
            </div>
            <a href="https://etherscan.io/token/${t.contract}" 
               target="_blank"
               style="color:#0aff9d;font-size:12px;">
              ${shortAddr(t.contract)}
            </a>
          </div>
        </div>
      `;
    });
  }
}

</script>

</body>
</html>
