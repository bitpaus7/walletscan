<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EVM Wallet Tracker</title>

<style>
body {
  background: #000;
  color: white;
  font-family: Arial, sans-serif;
  padding: 20px;
}

input {
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: none;
  margin-top: 10px;
  background: #111;
  color: white;
  font-size: 16px;
}

button {
  width: 100%;
  padding: 12px;
  margin-top: 15px;
  background: #0aff9d;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  color: #000;
}

button:hover {
  opacity: 0.85;
}

#loader {
  display: none;
  font-size: 20px;
  text-align: center;
  padding: 20px;
  color: #0aff9d;
}

h2 {
  margin-bottom: 10px;
}

h3 {
  margin-top: 25px;
  color: #0aff9d;
}

/* Token Card */
.token-box {
  display: flex;
  background: #111;
  padding: 12px;
  margin-bottom: 12px;
  border-radius: 10px;
  align-items: center;
  gap: 12px;
  border: 1px solid #222;
}

/* Logo token kecil */
.token-box img {
  width: 28px;
  height: 28px;
  border-radius: 50%;
}

/* Token text */
.token-symbol {
  font-size: 18px;
  font-weight: bold;
}

.token-amount {
  font-size: 14px;
  color: #ccc;
}

.token-usd {
  color: #0aff9d;
  font-size: 14px;
}

.token-marketcap {
  font-size: 12px;
  color: #888;
  margin-top: 2px;
}
</style>

</head>
<body>

<h1>EVM Wallet Tracker</h1>

<input id="wallet" placeholder="Masukkan alamat wallet (0x...)">
<button onclick="cekWallet()">Start Tracking</button>

<div id="loader" class="loader" style="display:none;">üîç Scanning wallet...</div>

<div id="result"></div>

<script>

const API_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJub25jZSI6IjA2OTE5MmFmLTAxNzctNDBkYi04NjQwLTYzN2I0ZjJmNmNlMSIsIm9yZ0lkIjoiNDgzNjY0IiwidXNlcklkIjoiNDk3NjAzIiwidHlwZUlkIjoiYzU3ZjA0YTktNDM4Ni00MDQ5LWFhMGUtOWVmNTBmMmJlNWExIiwidHlwZSI6IlBST0pFQ1QiLCJpYXQiOjE3NjQzNzAyMzMsImV4cCI6NDkyMDEzMDIzM30.0kda5g8LQ3pI9SHBOaRK8dWkJSsELOWwQlojPEJDP_o";

const CHAINS = {
    "eth": "Ethereum",
    "bsc": "BNB Chain",
    "polygon": "Polygon",
    "avalanche": "Avalanche",
    "arbitrum": "Arbitrum",
    "fantom": "Fantom",
    "optimism": "Optimism"
};

async function cekWallet() {
    const wallet = document.getElementById("wallet").value.trim();
    const loader = document.getElementById("loader");
    const result = document.getElementById("result");

    result.innerHTML = "";

    if (!wallet) {
        result.innerHTML = "Masukkan alamat wallet!";
        return;
    }

    loader.style.display = "block";

    let totalUSD = 0;
    let perChain = {};

    for (const chain in CHAINS) {
        try {
            const res = await fetch(
                `https://deep-index.moralis.io/api/v2.2/wallets/${wallet}/tokens?chain=${chain}`,
                { headers: { "X-API-Key": API_KEY } }
            );

            const data = await res.json();
            if (!data || !data.result) continue;

            let tokens = [];

            data.result.forEach(t => {

                if (!t.usd_price || t.usd_price === 0) return;
                if (t.possible_spam === true) return;

                const amount = t.balance / (10 ** t.decimals);
                const usdValue = amount * t.usd_price;

                if (usdValue < 0.1) return;

                totalUSD += usdValue;

                tokens.push({
                    symbol: t.symbol,
                    amount: amount,
                    usd: usdValue,
                    logo: t.logo || t.thumbnail || "https://via.placeholder.com/32",
                    marketcap: t.market_cap || null
                });
            });

            tokens.sort((a, b) => b.usd - a.usd);

            perChain[chain] = tokens;

        } catch (err) {
            console.error("Error chain:", chain, err);
        }
    }

    loader.style.display = "none";

    result.innerHTML = `
        <h2>Total Aset: $${totalUSD.toFixed(2)}</h2>
    `;

    for (const chain in perChain) {
        const tokens = perChain[chain];
        if (!tokens || tokens.length === 0) continue;

        result.innerHTML += `<h3>${CHAINS[chain]}</h3>`;

        tokens.forEach(t => {
            result.innerHTML += `
                <div class="token-box">
                    <img src="${t.logo}">
                    <div style="flex:1;">
                        <div style="font-size:18px;font-weight:bold;">${t.symbol}</div>
                        <div>${t.amount.toFixed(4)} (${t.usd.toFixed(2)} USD)</div>
                        <div style="font-size:12px;color:#0aff9d;">
                            Marketcap: ${t.marketcap ? "$" + Number(t.marketcap).toLocaleString() : "-"}
                        </div>
                    </div>
                </div>
            `;
        });
    }
}
</script>

</body>
</html>
